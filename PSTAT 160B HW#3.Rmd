---
title: "PSTAT 160B HW#3"
output:
  word_document: default
  pdf_document: default
  html_document: default
---

# The true value of y
```{r}
lambda <- 1
k <- 7
t <- 1
y <- c()
for(l in c(1:7)){
  y[l]<- ((lambda*t)^(l-1))/(factorial(l-1))
}
y <- 1 - (exp(-lambda*t)*sum(y))

y 
```
# The true value of y is 8.324115e-05.

# Simulating X
```{r}
lambda <- 1
k <- 7
t <- 1
n <- 10^5

Nt <- rpois(n, lambda)
indicator <- 0+(Nt >= k)
X <- indicator

x_hat <- mean(X) # x_hat estimator
sampVarx <- var(X) # sample variance of X
error <- (2.58)*sqrt((sampVarx)/n)

confInt_low <- (x_hat - error)
confInt_high <- (x_hat + error)
confint <- c(confInt_low,confInt_high)

sum(X)
x_hat
confint
```
# We are 99% confident that the true value of y lies in the confidence interval given by simulating X and finding our estimator x_hat. Our estimator, x_hat, is 8e-05, and our confidence interval is (7.029134e-06, 1.529709e-04). The true value y, 8.324115e-05, lies within our confidence interval.

# Simulating Y
```{r}
lambda <- 1
k <- 7
t <- 1
n <- 10^5
theta <- k/t

Kt <- rpois(n, theta*t)
indicator <- (Kt >= k)
Y <- indicator*((lambda/theta)^(Kt))*exp(-(lambda-theta)*t)

y_hat <- mean(Y)
sampVary <- var(Y) # sample variance of X
error <- (2.58)*sqrt((sampVary)/n)

confInt_low <- (y_hat - error)
confInt_high <- (y_hat + error)
confint <- c(confInt_low,confInt_high)

y_hat
confint
```
# We are 99% confident that the true value of y lies in the confidence interval given by simulating Y and finding our estimator y_hat. Our estimator, y_hat, is 8.356515e-05, and our confidence interval is (8.216312e-05, 8.496717e-05). The true value y, 8.324115e-05, lies within our confidence interval.

# y_hat is the best estimator for the true value of y. Its value is closest to the true value of y compared to x_hat. 

# Y is an importance sampling estimator of y and X is the plain Monte Carlo estimator of y.

# New value of theta for Y
```{r}
lambda <- 1
k <- 7
t <- 1
n <- 10^5
theta <- 0.5

Kt <- rpois(n, theta*t)
indicator <- (Kt >= k)
Y <- indicator*((lambda/theta)^(Kt))*exp(-(lambda-theta)*t)

y_hat <- mean(Y)
sampVary <- var(Y) # sample variance of X
error <- (2.58)*sqrt((sampVary)/n)

confInt_low <- (y_hat - error)
confInt_high <- (y_hat + error)
confint <- c(confInt_low,confInt_high)

y_hat
confint
```
# For values smaller than 0.5 for theta, the estimator gets as small as 0.

```{r}
lambda <- 1
k <- 7
t <- 1
n <- 10^5
theta <- 25

Kt <- rpois(n, theta*t)
indicator <- (Kt >= k)
Y <- indicator*((lambda/theta)^(Kt))*exp(-(lambda-theta)*t)

y_hat <- mean(Y)
sampVary <- var(Y) # sample variance of X
error <- (2.58)*sqrt((sampVary)/n)

confInt_low <- (y_hat - error)
confInt_high <- (y_hat + error)
confint <- c(confInt_low,confInt_high)

y_hat
confint
```
# The bigger the value of theta (larger than k/t), the smaller our estimator becomes.

```{r}
lambda <- 1
k <- 7
t <- 1
n <- 10^5
theta <- 710

Kt <- rpois(n, theta*t)
indicator <- (Kt >= k)
Y <- indicator*((lambda/theta)^(Kt))*exp(-(lambda-theta)*t)

y_hat <- mean(Y)
sampVary <- var(Y) # sample variance of X
error <- (2.58)*sqrt((sampVary)/n)

confInt_low <- (y_hat - error)
confInt_high <- (y_hat + error)
confint <- c(confInt_low,confInt_high)

y_hat
confint
```

```{r}
lambda <- 1
k <- 7
t <- 1
n <- 10^5
theta <- 711

Kt <- rpois(n, theta*t)
indicator <- (Kt >= k)
Y <- indicator*((lambda/theta)^(Kt))*exp(-(lambda-theta)*t)

y_hat <- mean(Y)
sampVary <- var(Y) # sample variance of X
error <- (2.58)*sqrt((sampVary)/n)

confInt_low <- (y_hat - error)
confInt_high <- (y_hat + error)
confint <- c(confInt_low,confInt_high)

y_hat
confint
```
# For any theta value greater than 710, the estimator becomes so small that it does not exist anymore.